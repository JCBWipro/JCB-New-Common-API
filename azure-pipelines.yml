# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

parameters:
 - name: moduleName
   displayName: 'Module Name'
   type: string
   default: 'JCB-API-Gateway'

trigger:
- Team-NextGen

pool:
  vmImage: windows-latest

stages:
 - stage: Build
   jobs:
    - job: Build
      steps:
      #  - script: |
      #      echo "##vso[task.setvariable variable=MODULE_NAME]JCB-API-Gateway"
      #    displayName: 'Set Maven POM Path'
      #  - script: |
      #      echo "##vso[task.setvariable variable=mavenPomPath]$(Build.SourceDirectory)/$(moduleName)/pom.xml"
      #    displayName: 'Set Maven POM Path'

        - task: Maven@3
          inputs:
            mavenPomFile: '$(system.defaultworkingdirectory)/**/*.xml'
            mavenOptions: '-Xmx3072m'
            javaHomeOption: 'JDKVersion'
            jdkVersionOption: '1.17'
            jdkArchitectureOption: 'x64'
            publishJUnitResults: true
            testResultsFiles: '**/surefire-reports/TEST-*.xml'
            goals: 'package'
